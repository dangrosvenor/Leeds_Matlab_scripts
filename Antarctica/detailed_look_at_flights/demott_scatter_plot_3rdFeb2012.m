max_ice = [...
0.037 ...
0.18 ...
0.12 ...
0.037 ...
0.16 ...
0.096 ...
0.017 ...
0.02 ...
0.026 ...
0.95 ...
3.4 ...
5 ...
4 ...
2.64];

max_ice_un=[...
0.009 ...
0.02 ...
0.02 ...
0.009 ...
0.02 ...
0.016 ...
0.006 ...
0.007 ...
0.009 ...
0.06 ...
0.1 ...
0.1 ...
0.1 ...
0.1];

%new as of 18th Jan, 2012
max_ice = [...
0.0398...
0.2218...
0.0232...
0.0372...
0.1596...
0.0592...
0.1134...
0.0116...
0.0531...
0.0171...
0.0199...
0.0315...
1.2827...
3.4437...
6.2566...
0.0583...
0.0674...
2.6966...
];

max_ice_un=[...
0.0094...
0.0260 ...
0.0077 ...
0.0093 ...
0.0199 ...
0.0124 ...
0.0175 ...
0.0052 ...
0.0125 ...
0.0065 ...
0.0066 ...
0.0095 ...
0.0649 ...
0.1071 ...
0.1462 ...
0.0130 ...
0.0144 ...
0.0978 ...
];

%even newer as of 13th March, 2012
%new as of 18th Jan, 2012
max_ice = [...
0.0138 ...
0.0154 ...
0.0398 ...
0.2218 ...
0.1484 ...
0.0232 ...
0.0372 ...
0.1596 ...
0.0299 ...
0.0592 ...
0.1134 ...
0.0531 ...
0.0171 ...
0.0199 ...
0.0116 ...
0.0315 ...
1.2827 ...
3.4437 ...
6.2566 ...
4.7725 ...
0.0583 ...
0.0674 ...
0.3714 ...
2.6966 ...
];

max_ice_un=[...
0.0057	 ...
0.0054	 ...
0.0094	 ...
0.026	 ...
0.0183	 ...
0.0077	 ...
0.0093	 ...
0.0199	 ...
0.0083	 ...
0.0124	 ...
0.0175	 ...
0.0125	 ...
0.0065	 ...
0.0066	 ...
0.0052	 ...
0.0095	 ...
0.0649	 ...
0.1071	 ...
0.1462	 ...
0.1211	 ...
0.013	 ...
0.0144	 ...
0.0323	 ...
0.0978	 ...
];





clear demott cooper meyers fletcher demott_half demott_double

                   %removing the zero ice periods
                   naers=[0.33 0.15 0.15 0.19 0.19 0.15 0.33 0.33 0.15 0.42 0.42 0.42 0.42 0.1];
                   Ts_demott=[-14.1 -10.3 -19.3 -9.8 -10.8  -16.7 -13.8 -16.4 -12.8 -0.5 -2.4 -4.4 -5.9 -2.3];

                   %new as of 18th Jan, 2012
                   naers = [0.33 0.15 0.15 0.19 0.19 0.19 0.15 0.15 0.15 0.33 0.33 0.15 0.42 0.42 0.42 0.42 0.42 0.10];
                   Ts_demott = [-14.2 -10.8 -10.2 -9.8 -10.8 -11.6 -17.4 -17.7 -20.2 -13.8 -16.5 -13.4 -0.7 -2.3 -4.3 -5.6 -5.2 -2.3];
                
                   %even newer as of 13th March
                   naers = [...
                       0.33	 ...
                       0.33	 ...
                       0.33	 ...
                       0.15	 ...
                       0.15	 ...
                       0.15	 ...
                       0.19	 ...
                       0.19	 ...
                       0.19	 ...
                       0.19	 ...
                       0.15	 ...
                       0.15	 ...
                       0.33	 ...
                       0.33	 ...
                       0.15	 ...
                       0.15	 ...
                       0.42	 ...
                       0.42	 ...
                       0.42	 ...
                       0.42	 ...
                       0.42	 ...
                       0.42	 ...
                       0.1	 ...
                       0.1	 ...
                       ];
                   
                   
                   Ts_demott = [...
                   -14.5 ...
                   -14.4 ...
                   -14.2 ...
                   -10.8 ...
                   -12.4 ...
                   -10.2 ...
                   -9.8 ...
                   -10.8 ...
                   -10.2 ...
                   -11.6 ...
                   -17.4 ...
                   -20.2 ...
                   -13.8 ...
                   -16.5 ...
                   -17.7 ...
                   -13.4 ...
                   -0.7 ...
                   -2.3 ...
                   -4.3 ...
                   -5.9 ...
                   -5.6 ...
                   -5.2 ...
                   -2.3 ...
                   -2.3 ];

                
                   a=0.0000594;
                   b=3.33;
                   c=0.0264;
                   d=0.0033;
                   
                   for in=1:length(naers)
                       tc=Ts_demott(in);
                       TK=tc+273.15;
                       naer=naers(in);
                       demott(in)=a*(273.16-TK).^b.*naer.^(c.*(273.16-TK)+d);
                       cooper(in)=0.005*exp(0.304*(-tc)); %per L
                       
                       ev=satvappress(273+tc,'goff','liq'); %assume ev=water saturation vap press
                       evi=satvappress(273+tc,'goff','ice'); %ice sat vap press
                       meyers(in)=exp(-6.69+12.96*ev./evi)*1e-3; %
                       %
                       fletcher(in)=0.01*exp(-0.6*tc)*1e-3; %per L
                       
%                       fprintf(1,'\n%f,%f,%.2g %.2g %.2g %.2g',tc,naer,demott(in),cooper(in),meyers(in),fletcher(in));
                        fprintf(1,'\n%.2g& %.2g& %.2g& %.2g\\\\',demott(in),cooper(in),meyers(in),fletcher(in));
                   end
                   
                   for in=1:length(naers)
                       tc=Ts_demott(in);
                       TK=tc+273.15;
                       naer=naers(in)*0.5;
%                       naer=naers(in)*0.25;                       
                       demott_half(in)=a*(273.16-TK).^b.*naer.^(c.*(273.16-TK)+d);
                      
                    %   fprintf(1,'\n%.2g',demott_half(in));
                       
                   end
                   
                   for in=1:length(naers)
                       tc=Ts_demott(in);
                       TK=tc+273.15;
                       naer=naers(in)*2;
%                       naer=naers(in)*4;                       
                       demott_double(in)=a*(273.16-TK).^b.*naer.^(c.*(273.16-TK)+d);
                      
                   %    fprintf(1,'\n%.2g',demott_double(in));
                       
                   end
                   
 %here am moving the 1e-6 point to 5e-4 to make it fit on the graph better with the rest
 %of the data - 1e-6 & 5e-4 are both low enough to be considered zero
% demott(demott<5e-4)=5e-4;
% demott_half(demott_half<5e-4)=5e-4;
% demott_double(demott_double<5e-4)=5e-4;

figure
hold on
%grid;

%draw the vertical error bars - need to do 'bo' to stop it connecting the
%lines between the markers
%note - the values are the error above and below the x,y value (e.g. dy_lower, not
%y-dy_lower)
B=max_ice_un;
A=max_ice_un;
hEv=errorbar(demott,max_ice,B,A,'bo');

%adjust the properties - note, don't need to also do the markers for the
%horizontal error bars
set(hEv                           , ...
  'LineWidth'       , 2           , ...
  'Color'           , [.3 .3 .3]  , ...
  'MarkerSize'      , 6           , ...
  'MarkerEdgeColor' , [.2 .2 .2]  , ...
  'MarkerFaceColor' , [.7 .7 .7]  );

%plot them again as setting the marker face color blots out the errorbars
%within the marker
hEv=errorbar(demott,max_ice,B,A,'bo');
set(hEv                           , ...
  'LineWidth'       , 2           , ...
  'Color'           , [.3 .3 .3]  );



% adjust vertical error bars to remove the "tails" at the end
hE_c  =  get(hEv     , 'Children'    );

errorbarXData          = ...
    get(hE_c(2), 'XData'       );

errorbarXData(4:9:end) = ...
    errorbarXData(1:9:end);
errorbarXData(7:9:end) = ....
    errorbarXData(1:9:end);
errorbarXData(5:9:end) = ...
    errorbarXData(1:9:end);
errorbarXData(8:9:end) = ...
    errorbarXData(1:9:end);
set(hE_c(2), 'XData', errorbarXData);


%draw the horizontal error bars
L=demott-demott_half;
R=demott_double-demott;
hEh=herrorbar(demott,max_ice,L,R,'bo');

set(hEh                           , ...
  'LineWidth'       , 2           , ...
  'Color'           , [.3 .3 .3] );


% adjust horizontal error bars to remove the "tails" at the end
errorbarYData          = ...
    get(hEh(1), 'YData'       );

errorbarYData(1:9:end) = ...
    errorbarYData(4:9:end);
errorbarYData(2:9:end) = ....
    errorbarYData(4:9:end);
errorbarYData(7:9:end) = ...
    errorbarYData(4:9:end);
errorbarYData(8:9:end) = ...
    errorbarYData(4:9:end);
set(hEh(1), 'YData', errorbarYData);


xlabel('DeMott IN prediction (L^{-1})','fontsize',14);
ylabel('Observed max 60s ice concentration (L^{-1})','fontsize',14);


axlims=[1e-4 1e1];
axlims=[1e-5 1e1];
axlims=[0.006 0.8]; %for the close up
set(gca,'fontsize',12);
set(gca,'xlim',axlims);
set(gca,'ylim',axlims);

h_one=line(axlims,axlims);
set(h_one                           , ...
  'LineWidth'       , 2           );
set(gca,'xscale','log');
set(gca,'yscale','log');


savedir='C:\Users\Dan\Documents\logbook\Antarctica\Flights and instruments\plots\';
savename=[savedir 'DeMott vs Obs ice scatter plot'];



return
set(gca,'xlim',[1e-2 1]);
set(gca,'ylim',[1e-2 1]);
savename2=[savedir 'DeMott vs Obs ice scatter plot zoom inset'];


