%For NP use for e.g. the Cloud_Fraction_Liquid_Pixel_Counts divided by the
%CF_liq, since pixel counts are the no. liquid pixels used for CF determination,
%(i.e. the numerator (top) of the fraction CF_liq = Nliq/Ntot
%So Ntot is Nliq/CF_liq

% *** IMPORTANT - make sure that (ilat,ilon,itime) is used for the screening arrays 
%  - even if all of the array is being used since the itime indices are not in order, which means the
% order will be different from that of the data arrays if itime is not
% used. ***

% *** Also an IMPORTANT technicality:-
%   The method used here is to find set up the screen-str to represent all of the points that lie within the
%   range of the bounds. 
%   And then to do ihtot = find( ~eval(screen_str) ) to find the points to be removed.
%   I.e. all of the remaining points out of the set that satisfy
%   screen_str. 
%   Importantly, this will also include any locations where teh screening
%   data was NaN since NaN data will not satisfy the screen_str logical and
%   so will be included using the NOT. If just finding and removing the locations
%   OUTSIDE of the screening bounds then it will include locations where
%   the screening data is NaN, which we do not want to do.

%Some details on the new screenings for the SZA paper :-
% minfrac_CF = 0.9; %minimum fraction of the sampled points that had successful cloudy/clear/phase
%       %determination (i.e. Npix/Nptot_mockL3 =
%       %(Cloud_Fraction_Liquid_Pixel_Counts./Cloud_Fraction_Liquid)./Total_pixels
%       % - Restriction (2) as presented in the paper
% 
% minfrac_NpNd = 0.9; 
       %Cloud_Fraction_Liquid_Pixel_Counts2.timeseries3./Cloud_Fraction_Liquid_Pixel_Counts.timeseries3
       %Fraction of points that remain after all previous filtering for
       %which we have an Nd retrieval. 
       % - Restriction (4) in the SZA paper.
%             
% thresh_NP_Nd = 50; %min no. of pixels required for an Nd, re, tau, etc measurement to count
%       %(Uses Cloud_Fraction_Liquid_Pixel_Counts2). For this screening
%       %usually
%       

% thresh_NP -- uses Total_pixels>=thresh_NP
  %the minimum number of pixels that the swath must have covered -
%       %i.e. the total number of pixels available (were scanned by the
%       swath)
%       

% thresh_CF will be used for Restriction (3) in the paper (fraction of
              % pixels that had sucessful cloud phase/clear deterimination that were
              % liquid)
              
screen_str='';

if exist('CTH')
    if minALL(CTH.timeseries3)>9.99e7
        disp('--- *** WARNING - not CTH data for screening with! *** ---');
    end
end
              
              
% screen_type = 'NP3 + CF3 + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau + mean_CTH' 
        %is the one to select for the SZA Arctic paper screening              
% Cloud_Fraction_Liquid_Pixel_Counts2./Cloud_Fraction_Liquid_Pixel_Counts>=minfrac_NpNd
if exist('Cloud_Fraction_Liquid_Pixel_Counts2')
   frac_NpNd = Cloud_Fraction_Liquid_Pixel_Counts2.timeseries3./Cloud_Fraction_Liquid_Pixel_Counts.timeseries3;
end
% &
% Cloud_Fraction_Liquid_Pixel_Counts./Cloud_Fraction_Liquid./Total_pixels>=minfrac_CF  
%    -- fraction of Total_Pixels that were used to determine the liquid
%    cloud fraction (no. designated as liquid, ice, undet, or clear)
if exist('Total_pixels')
   frac_CF = Cloud_Fraction_Liquid_Pixel_Counts.timeseries3./Cloud_Fraction_Liquid.timeseries3./Total_pixels.timeseries3;% & Total_pixels>=thresh_NP   -- no. pixels captured by the MODIS swath
end
% & Cloud_Fraction_Liquid>thresh_CF(1) & Cloud_Fraction_Liquid<=thresh_CF(2)
% & Sensor_Zenith_Mean>thresh_sensZA(1) & Sensor_Zenith_Mean<=thresh_sensZA(2)
% & Relative_Azimuth_Mean>thresh_relAZ(1) & Relative_Azimuth_Mean<=thresh_relAZ(2)
% & homog_time3>thresh_stdW(1) & homog_time3<thresh_stdW(2)
% & Solar_Zenith_Mean>=thresh_SZA(1) & Solar_Zenith_Mean<thresh_SZA(2)
% & Cloud_Top_Temperature_Day_Mean >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean < thresh_CTT(2)
% & CTH >= thresh_CTH(1) & CTH < thresh_CTH(2))']; 

iplot_global_orig = iplot_global;

if iplot_global==1 & igcm_screen==0
       

%     itime=1:size(Cloud_Fraction_Liquid.timeseries3,3);
     if exist('daynum_timeseries3') & ~strcmp(mod_data_type,'L2 swath')
         itime=1:length(daynum_timeseries3);
         ilat=1:length(MLAT);
         ilon=1:length(MLON);
     elseif exist('Cloud_Fraction_Liquid')
         itime=1:size(Cloud_Fraction_Liquid.timeseries3,3);
         ilat=1:size(Cloud_Fraction_Liquid.timeseries3,1);
         ilon=1:size(Cloud_Fraction_Liquid.timeseries3,2);
     end

end

if exist('igcm_screen') & igcm_screen==1
    disp('*** NOTE - igcm_screen is set to one. May mean that ilat and ilon are not set if this is accidental')
end

screenings='OLD';
screenings='NEW';

switch screenings
    case 'NEW' %the old ones didn't use the combined CF to check that only the requested CF
        %type is present. I.e. if request CF_liq>0.8 then this could be
        %satisifed when we also have CF_ice=0.2

        switch screen_type
            case 'gcm_screening'
                screen_str = [' ( gcm_landmask_rep==0 & screen_tlwp >= thresh_gcm_tlwp(1) & screen_tlwp < thresh_gcm_tlwp(2) & screen_lwp >= thresh_gcm_lwp(1) & screen_lwp < thresh_gcm_lwp(2) &  screen_precip >= thresh_gcm_precip(1) & screen_precip < thresh_gcm_precip(2) &  screen_cf >= thresh_gcm_cf(1) & screen_cf < thresh_gcm_cf(2)  )']; thresh_str=['LWP.GTE' num2str(thresh_gcm_lwp(1)) '.AND.LT.' num2str(thresh_gcm_lwp(2)) ' g m^{-2}, precip GTE.' num2str(thresh_gcm_precip(1)) '.AND.LT.' num2str(thresh_gcm_precip(2)) ' mm day^{-1}, CF.GTE.' num2str(thresh_gcm_cf(1)) '.AND.LT.' num2str(thresh_gcm_cf(2)) ', TLWP.GTE' num2str(thresh_gcm_tlwp(1)) '.AND.LT.' num2str(thresh_gcm_tlwp(2)) ' g m^{-2} for ' ocean_only_flag];                
            case 'calipso_high_cloud_ocean_only'
                screen_str = [' ( clh_int_rep >= thresh_calipso_highCF(1) & clh_int_rep < thresh_calipso_highCF(2) & gcm_landmask_rep<0.01 & isnan(gcm_landmask_rep)==0   )'];
                thresh_str=['CALIPSO_MHCF.GTE.' num2str(thresh_calipso_highCF(1)) '.AND.LT.' num2str(thresh_calipso_highCF(2)) ', ocean only'];                
            case 'CTH L2 swath'; %
                screen_str = [' ( CTH_L2 >= thresh_CTH(1) & CTH_L2 < thresh_CTH(2) )'];
                thresh_str=['CTH.GTE.' num2str(thresh_CTH(1)) '.AND.LT.' num2str(thresh_CTH(2))];  
            case 'CTH + SZA L2 swath'; %
                screen_str = [' ( CTH_L2 >= thresh_CTH(1) & CTH_L2 < thresh_CTH(2) & solarZA_L2 >= thresh_SZA(1) & solarZA_L2 < thresh_SZA(2))'];
                thresh_str=['CTH.GTE.' num2str(thresh_CTH(1)) '.AND.LT.' num2str(thresh_CTH(2)) ...
                    '.AND.GTE.' num2str(thresh_SZA(1)) '.AND.LT.' num2str(thresh_SZA(2))];                   
            case 'CTH only'; %
                screen_str = [' ( CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2) )'];
                thresh_str=['CTH.GTE.' num2str(thresh_CTH(1)) '.AND.LT.' num2str(thresh_CTH(2))];                
            case 'CTH only with no zeroCF screening'; %Not allowing CTH screening if there is zero CF. For Level-3 data (not mockL3)
                screen_str = [' ( (CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2)) |  Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_zeroCF )']; thresh_str=['CTH.GTE.' num2str(thresh_CTH(1)) '.AND.LT.' num2str(thresh_CTH(2)) ' with no CTH screening for CF.LT.' num2str(thresh_zeroCF)];                                
            case 'CTH_Ryan only with no zeroCF screening'; %Not allowing CTH screening if there is zero CF. For Level-3 data (not mockL3)
                screen_str = [' ( (CTH_Ryan(ilat,ilon,itime) >= thresh_CTH(1) & CTH_Ryan(ilat,ilon,itime) < thresh_CTH(2)) |  Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_zeroCF )']; thresh_str=['CTH_Ryan.GTE.' num2str(thresh_CTH(1)) '.AND.LT.' num2str(thresh_CTH(2)) ' with no CTH screening for CF.LT.' num2str(thresh_zeroCF)];                                                
            case 'CTH_adjust only with no zeroCF screening'; %Not allowing CTH screening if there is zero CF. For Level-3 data (not mockL3)
                screen_str = [' ( (CTH_adjust(ilat,ilon,itime) >= thresh_CTH(1) & CTH_adjust(ilat,ilon,itime) < thresh_CTH(2)) |  Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_zeroCF )']; thresh_str=['CTH_adjust.GTE.' num2str(thresh_CTH(1)) '.AND.LT.' num2str(thresh_CTH(2)) ' with no CTH screening for CF.LT.' num2str(thresh_zeroCF)];                                                                
            case 'CTP only with no zeroCF screening'; %Not allowing CTP screening if there is zero CF. For Level-3 data (not mockL3)
                screen_str = [' ( (Cloud_Top_Pressure_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTP(1) & Cloud_Top_Pressure_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTP(2)) |  Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_zeroCF )']; thresh_str=['CTP.GTE.' num2str(thresh_CTP(1)) '.AND.LT.' num2str(thresh_CTP(2)) ' with no CTP screening for CF.LT.' num2str(thresh_zeroCF)];                                                
            case 'CTP and CTH only with no zeroCF screening'; %Not allowing CTP screening if there is zero CF. For Level-3 data (not mockL3)
                screen_str = [' ( (Cloud_Top_Pressure_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTP(1) & Cloud_Top_Pressure_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTP(2)) & (CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2)) |  Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_zeroCF )']; thresh_str=['CTP.GTE.' num2str(thresh_CTP(1)) '.AND.LT.' num2str(thresh_CTP(2)) 'AND CTH.GTE.' num2str(thresh_CTH(1)) '.AND.LT.' num2str(thresh_CTH(2)) ' with no CTP screening for CF.LT.' num2str(thresh_zeroCF)];                                                                
            case 'max CTH only with no zeroCF screening'; %Not allowing CTH screening if there is zero CF. For Level-3 data (not mockL3)
                screen_str = [' ( (CTH_max.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH_max.timeseries3(ilat,ilon,itime) < thresh_CTH(2)) |  Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_zeroCF )']; thresh_str=['CTH_max.GTE.' num2str(thresh_CTH(1)) '.AND.LT.' num2str(thresh_CTH(2)) ' with no CTH screening for CF.LT.' num2str(thresh_zeroCF)];                                
            case 'Min CTP only with no zeroCF screening'; %Not allowing CTP screening if there is zero CF. For Level-3 data (not mockL3)
                screen_str = [' ( (Cloud_Top_Pressure_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTP(1) & Cloud_Top_Pressure_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTP(2)) |  Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_zeroCF )']; thresh_str=['CTP.GTE.' num2str(thresh_CTP(1)) '.AND.LT.' num2str(thresh_CTP(2)) ' with no CTP screening for CF.LT.' num2str(thresh_zeroCF)];                                                                                
            case 'min_CTP and max_CTH hybrid only with no zeroCF screening'; %Not allowing CTP screening if there is zero CF. For Level-3 data (not mockL3)
                screen_str = [' ( (CTP_min_hybrid.timeseries3(ilat,ilon,itime) >= thresh_CTP(1) & CTP_min_hybrid.timeseries3(ilat,ilon,itime) < thresh_CTP(2)) | (CTH_max_hybrid.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH_max_hybrid.timeseries3(ilat,ilon,itime) < thresh_CTH(2)) |  Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_zeroCF )']; thresh_str=['CTP.GTE.' num2str(thresh_CTP(1)) '.AND.LT.' num2str(thresh_CTP(2)) 'AND CTH.GTE.' num2str(thresh_CTH(1)) '.AND.LT.' num2str(thresh_CTH(2)) ' with no CTP screening for CF.LT.' num2str(thresh_zeroCF)];                                                                            
            
            case 'CTH only, include NaN CTHs'; %If the CTH is NaN then include the CF whatever it is. For Level-3 data (not mockL3)
                screen_str = [' ( (CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2)) |  isnan(CTH.timeseries3(ilat,ilon,itime))==1 )']; thresh_str=['CTH.GTE.' num2str(thresh_CTH(1)) '.AND.LT.' num2str(thresh_CTH(2)) ' with no screening of NaN CTHs'];                                                
%            case 'CTH only, but allow NaN CTHs with low CF'; %Not allowing CTH screening if there is zero CF. For Level-3 data (not mockL3)
%                screen_str = [' ( (CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2)) |  Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime) < 0.05 )']; thresh_str=['CTH.GTE.' num2str(thresh_CTH(1)) '.AND.LT.' num2str(thresh_CTH(2)) ' with no screening of zero CFs'];                                                
            case 'NP + CF_L3'; %For Level-3 data (not mockL3)
                fprintf(1,'\n*** MAKE sure that this is the correct CF - for mockL3 data use NP + CF mockL3***\n');
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.01 )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2))];
                
            case 'NP + CF_L3 + max_SZA + std_SZA'; %For Level-3 data (not mockL3)
                fprintf(1,'\n*** MAKE sure that this is the correct CF - for mockL3 data use NP + CF mockL3***\n');
                screen_str = [' ('...
                    'Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP'...
                    '& Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)'...
                    '& (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.01'...
                    '& Solar_Zenith_Maximum.timeseries3(ilat,ilon,itime)>thresh_maxSZA(1) & Solar_Zenith_Maximum.timeseries3(ilat,ilon,itime)<=thresh_maxSZA(2)'...
                    '& Solar_Zenith_Standard_Deviation.timeseries3(ilat,ilon,itime)>thresh_stdSZA(1) & Solar_Zenith_Standard_Deviation.timeseries3(ilat,ilon,itime)<=thresh_stdSZA(2)'...
                    ')']; 
                thresh_str=['NP.GTE.' num2str(thresh_NP) ...
                    ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2))...
                    ' AND maxSZA.LT.' num2str(thresh_maxSZA(1)) ' AND maxSZA.LTE.' num2str(thresh_maxSZA(2))...                    
                    ' AND stdSZA.GT.' num2str(thresh_stdSZA(1)) ' AND stdSZA.LTE.' num2str(thresh_stdSZA(2))...                    
                    ];
                
        case 'NP + CF_L3 + dSZA'; %For Level-3 data (not mockL3)
            fprintf(1,'\n*** MAKE sure that this is the correct CF - for mockL3 data use NP + CF mockL3***\n');
            screen_str = [' ('...
                'Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP'...
                '& Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)'...
                '& (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.01 )'...
                '& dSZA(ilat,ilon,itime)>thresh_dSZA(1) & dSZA(ilat,ilon,itime)<=thresh_dSZA(2)'...
                ]; 
            thresh_str=['NP.GTE.' num2str(thresh_NP) ...
                ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2))...              
                ' AND dSZA.GT.' num2str(thresh_dSZA(1)) ' AND dSZA.LTE.' num2str(thresh_dSZA(2))...                    
                ];

                
            case 'NP3 + CF3 + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau + mean_CTH + sigCTT'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts2.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)>=minfrac_NpNd & Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)./Total_pixels.timeseries3(ilat,ilon,itime)>=minfrac_CF & Total_pixels.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2) & Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) >= thresh_sigCTT(1) & Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) < thresh_sigCTT(2))']; thresh_str=['Frac_CF.GTE.' num2str(minfrac_CF) ',NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND.Frac Nd.GTE.' num2str(minfrac_NpNd) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND meanCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) 'iceCF allowed, sigCTT.GTE.' num2str(thresh_sigCTT(1)) '.AND.LT.' num2str(thresh_sigCTT(2))];                                
            case 'NP3 + CF3 + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau + sigCTT'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts2.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)>=minfrac_NpNd & Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)./Total_pixels.timeseries3(ilat,ilon,itime)>=minfrac_CF & Total_pixels.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) >= thresh_sigCTT(1) & Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) < thresh_sigCTT(2))']; thresh_str=['Frac_CF.GTE.' num2str(minfrac_CF) ',NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND.Frac Nd.GTE.' num2str(minfrac_NpNd) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND iceCF allowed, sigCTT.GTE.' num2str(thresh_sigCTT(1)) '.AND.LT.' num2str(thresh_sigCTT(2))];                                                
            case 'NP4 + CF4 + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau + mean_CTH'
                screen_str = [' ( Pixel_fraction_Nd.timeseries3(ilat,ilon,itime)>=minfrac_CF & Total_pixels.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid_Pixel_Counts2.timeseries3(ilat,ilon,itime)>=thresh_NP_Nd & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2))']; thresh_str=['CloudFrac_Nd.GTE.' num2str(minfrac_CF) ',NP.GTE.' num2str(thresh_NP) ' AND.Frac Nd.GTE.' num2str(minfrac_NpNd) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND meanCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) 'iceCF allowed'];                                            
%*****************************************************************************
            case 'NP3 + CF3 + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau + mean_CTH'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts2.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)>=minfrac_NpNd & Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)./Total_pixels.timeseries3(ilat,ilon,itime)>=minfrac_CF & Total_pixels.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2))']; thresh_str=['Frac_CF.GTE.' num2str(minfrac_CF) ',NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND.Frac Nd.GTE.' num2str(minfrac_NpNd) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND meanCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) ' iceCF allowed'];                                
%**************************************************************************

                %For level-3 : 09 Jan 2014
                % NP + CF_L3, no iceCF allowed + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau + max_CTH with no zeroCF screening + sigCTT +sigW
                case 'NP + CF_L3, no iceCF allowed + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau + mean_CTH with no zeroCF screening + sigCTT +sigW'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.01 & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & stdW_time3(ilat,ilon,itime)>thresh_stdW(1) & stdW_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & ( CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2) |  Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_zeroCF ) & Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) >= thresh_sigCTT(1) & Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) < thresh_sigCTT(2))']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND meanCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) ' with no CTH screening for CF.LT.' num2str(thresh_zeroCF) ', iceCF not allowed, sigCTT.GTE.' num2str(thresh_sigCTT(1)) '.AND.LT.' num2str(thresh_sigCTT(2))];                                
                
                case 'NP + CF_L3, ice CF allowed + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau + mean_CTH with no zeroCF screening + sigCTT +sigW + reff'
                  screen_str = [' ('...
                    '  Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime) > thresh_reff(1) & Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime) <= thresh_reff(2)'...
                    '& Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP'...
                    '& Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)'...
                    '& Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2)'...
                    '& Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2)'...
                    '& stdW_time3(ilat,ilon,itime)>thresh_stdW(1) & stdW_time3(ilat,ilon,itime)<thresh_stdW(2)'...
                    '& Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2)'...
                    '& Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2)'...
                    '& ( CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2)'... 
                       ' | Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) < thresh_zeroCF )'...
                    '& Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) >= thresh_sigCTT(1) & Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) < thresh_sigCTT(2)'...
                    ')']; 
                  thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND meanCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) ' with no CTH screening for CF.LT.' num2str(thresh_zeroCF) ', iceCF allowed, sigCTT.GTE.' num2str(thresh_sigCTT(1)) '.AND.LT.' num2str(thresh_sigCTT(2)) ' AND Reff.GT.' num2str(thresh_reff(1)) '.AND.LTE.' num2str(thresh_reff(2))];                                
                
            case 'NP + CF_L3_MOD35, ice CF allowed + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau + mean_CTH with no zeroCF screening + sigCTT +sigW + reff'
                screen_str = [' ( (Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime) > thresh_reff(1) & Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime) <= thresh_reff(2) | isnan(Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime))==1) & Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & stdW_time3(ilat,ilon,itime)>thresh_stdW(1) & stdW_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & ( CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2) |  Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_zeroCF ) & Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) >= thresh_sigCTT(1) & Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) < thresh_sigCTT(2))']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND meanCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) ' with no CTH screening for CF.LT.' num2str(thresh_zeroCF) ', iceCF allowed, sigCTT.GTE.' num2str(thresh_sigCTT(1)) '.AND.LT.' num2str(thresh_sigCTT(2)) ' AND Reff.GT.' num2str(thresh_reff(1)) '.AND.LTE.' num2str(thresh_reff(2))];                                
                
            case 'NP + CF_L3, ice CF allowed + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau + mean_CTH with no zeroCF screening + sigCTT +sigW + reff + seaice'
                screen_str = [' ('...
                    '  (Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime) > thresh_reff(1) & Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime) <= thresh_reff(2) | isnan(Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime))==1 )' ...
                    '& Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP' ...
                    '& Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)'...                
                    '& Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2)'...
                    '& Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2)'...
                    '& stdW_time3(ilat,ilon,itime)>thresh_stdW(1) & stdW_time3(ilat,ilon,itime)<thresh_stdW(2)'...
                    '& Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2)'...
                    '& Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2)'...
                    '& ( CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2) |  Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) < thresh_zeroCF )'...
                    '& Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) >= thresh_sigCTT(1) & Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) < thresh_sigCTT(2)'...
                    '& seaice_max_time3(ilat,ilon,itime) >= thresh_seaice(1) & seaice_max_time3(ilat,ilon,itime) < thresh_seaice(2)'...
                    ')']; 
                
                thresh_str=['NP.GTE.' num2str(thresh_NP)...
                    ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2))...
                    ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2))...
                    ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2))...
                    ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2))...
                    ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2))...
                    ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))...
                    ' AND meanCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) ' with no CTH screening for CF.LT.' num2str(thresh_zeroCF)...
                    ', iceCF allowed, sigCTT.GTE.' num2str(thresh_sigCTT(1)) '.AND.LT.' num2str(thresh_sigCTT(2))...
                    ' AND Reff.GT.' num2str(thresh_reff(1)) '.AND.LTE.' num2str(thresh_reff(2))...
                    ' AND Seaice.GT.' num2str(thresh_seaice(1)) '.AND.LTE.' num2str(thresh_seaice(2))...
                    ];                                                
                
            case 'NP + CF_L3_MOD35, ice CF allowed + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau + max_CTH with no zeroCF screening + sigCTT +sigW + reff'
                screen_str = [' ( (Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime) > thresh_reff(1) & Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime) <= thresh_reff(2) | isnan(Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime))==1) & Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & stdW_time3(ilat,ilon,itime)>thresh_stdW(1) & stdW_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & ( CTH_max.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH_max.timeseries3(ilat,ilon,itime) < thresh_CTH(2) |  Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_zeroCF ) & Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) >= thresh_sigCTT(1) & Cloud_Top_Temperature_Day_Standard_Deviation.timeseries3(ilat,ilon,itime) < thresh_sigCTT(2))']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND maxCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) ' with no CTH screening for CF.LT.' num2str(thresh_zeroCF) ', iceCF allowed, sigCTT.GTE.' num2str(thresh_sigCTT(1)) '.AND.LT.' num2str(thresh_sigCTT(2)) ' AND Reff.GT.' num2str(thresh_reff(1)) '.AND.LTE.' num2str(thresh_reff(2))];                                                

            case 'NP + CF_L3_MOD35'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP' ...
                    '& Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Day_Mean.timeseries3(ilat,ilon,itime)<=thresh_CF(2) )'...
                    ]; 
                thresh_str=['NP.GTE.' num2str(thresh_NP) ...
                    ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ...
                    ];
                
%***************************************************************************
            case 'NP3 + CF3 + MEAN sensZA + MEAN relAZ + MEAN solarZA + min_CTT + min_tau + mean_CTH'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts2.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)>=minfrac_NpNd & Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)./Total_pixels.timeseries3(ilat,ilon,itime)>=minfrac_CF & Total_pixels.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2))']; thresh_str=['Frac_CF.GTE.' num2str(minfrac_CF) ',NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND.Frac Nd.GTE.' num2str(minfrac_NpNd) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND minCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND minCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) 'iceCF allowed'];                                                
  case 'NP3 + CF3 + MEAN sensZA + MEAN relAZ + MEAN solarZA + min_CTT + min_tau + mean_CTH + dreff'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts2.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)>=minfrac_NpNd & Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)./Total_pixels.timeseries3(ilat,ilon,itime)>=minfrac_CF & Total_pixels.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2) & rel_dreffs(ilat,ilon,itime) <= thresh_dreff )']; thresh_str=['Frac_CF.GTE.' num2str(minfrac_CF) ',NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND.Frac Nd.GTE.' num2str(minfrac_NpNd) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND minCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND minCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) 'iceCF allowed AND dreff.LTE.' num2str(thresh_dreff)];                                                                    
 case 'NP3 + CF3 + MEAN sensZA + MEAN relAZ + MEAN solarZA + min_CTT + min_tau + mean_CTH + dreff + ceil_nlayers + ceil_layer_max_height'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts2.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)>=minfrac_NpNd & Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)./Total_pixels.timeseries3(ilat,ilon,itime)>=minfrac_CF & Total_pixels.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2) & rel_dreffs(ilat,ilon,itime) <= thresh_dreff & ceil_nlayers(ilat,ilon,itime) >= thresh_nlayers(1) & ceil_nlayers(ilat,ilon,itime) <= thresh_nlayers(2) & ceil_layer_maxH(ilat,ilon,itime) > thresh_maxlayerH(1) & ceil_layer_maxH(ilat,ilon,itime) <= thresh_maxlayerH(2) )']; thresh_str=['Frac_CF.GTE.' num2str(minfrac_CF) ',NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND.Frac Nd.GTE.' num2str(minfrac_NpNd) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND minCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND minCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) 'iceCF allowed AND dreff.LTE.' num2str(thresh_dreff) ' AND ceilometer max layer height GT ' num2str(thresh_maxlayerH(1)) ' AND ceilometer max layer height LTE ' num2str(thresh_maxlayerH(2)) ' AND ceilometer nlayers.GTE.' num2str(thresh_nlayers(1)) ' AND ceilometer nlayers.LTE.' num2str(thresh_nlayers(2))];                                                                                    
% case 'NP3 + CF3 + MEAN sensZA + MEAN relAZ + MEAN solarZA + min_CTT + min_tau + mean_CTH + dreff + ceil_layer_max_height'
%                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts2.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)>=minfrac_NpNd & Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)./Total_pixels.timeseries3(ilat,ilon,itime)>=minfrac_CF & Total_pixels.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2) & rel_dreffs(ilat,ilon,itime) <= thresh_dreff & ceil_layer_max <= thresh_maxlayerH )']; thresh_str=['Frac_CF.GTE.' num2str(minfrac_CF) ',NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND.Frac Nd.GTE.' num2str(minfrac_NpNd) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND minCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND minCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) 'iceCF allowed AND dreff.LTE.' num2str(thresh_dreff) ' AND ceil_layer_max.LTE.' num2str(thresh_maxlayerH)];                                                                                    
                
                
            case 'NP2 + CF2 + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau + mean_CTH'
                screen_str = [' ( Total_pixels.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid_Pixel_Counts2.timeseries3(ilat,ilon,itime)>=thresh_NP_Nd & Pixel_fraction_Nd.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Pixel_fraction_Nd.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2))']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND meanCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) 'iceCF allowed'];                                                
            case 'MEAN solarZA'
                screen_str = [' ( Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) )']; thresh_str=['SolarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2))];                                            
            case 'MEAN solarZA + CF'
                screen_str = [' ( Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) )']; thresh_str=['SolarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2))];                                                            
            case 'MEAN solarZA + CF + NP'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) )']; thresh_str=['SolarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2))];                                                                            
            case 'NP + CF + MEAN sensZA + MEAN relAZ + MEAN solarZA + min_CTT + min_tau + mean_CTH + Cahalan_tau_homog'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2) & homog_tau_Cahalan >= thresh_homog_tau(1) & homog_tau_Cahalan < thresh_homog_tau(2))']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND minCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND minCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) ' AND homog_tau GTE.' num2str(thresh_homog_tau(1)) ' AND.LT.' num2str(thresh_homog_tau(2)) 'iceCF allowed'];                                            
            case 'NP + CF + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau + mean_CTH'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2))']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND minCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) 'iceCF allowed'];                                
            case 'NP + CF + MEAN sensZA + MEAN relAZ + MEAN solarZA + min_CTT + min_tau + mean_CTH'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2))']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND minCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND minCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) 'iceCF allowed'];                                
            case 'NP + CF + MEAN sensZA + MEAN relAZ + MEAN solarZA + min_CTT + min_tau + mean_CTH, no homog screening'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2)  & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2))']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2))  ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND minCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))  ' AND minCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) 'iceCF allowed, no homog screening'];  
            case 'NP + CF + MEAN sensZA + MEAN relAZ + MEAN solarZA, no homog screening' %Added Jan 2018 to find no. days with all CFs, but including no cloud
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2)  & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2))  ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) 'iceCF allowed, no homog screening'];             
                  
                
            case 'NP + CF + MEAN sensZA + MEAN relAZ + MEAN solarZA + min_CTT + mean_tau + mean_CTH, no homog screening, Jan2017'
                %This one actually includes the optical depth screening,
                %unlike the previous version of this (one above, although have also changed to mean_tau here)
                screen_str = [' (' ...
                    'Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) ' ...
                    '& Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2)' ...
                    '& Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2)'...
                    '& Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2)'...
                    '& Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTT(2)'...
                    '& CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2)'...
                    '& Cloud_Optical_Thickness_Liquid_Mean.timeseries3(ilat,ilon,itime) >= thresh_tau(1) & Cloud_Optical_Thickness_Liquid_Mean.timeseries3(ilat,ilon,itime) < thresh_tau(2)'...
                    ')'];                                
                
                thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ...
                    ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ...
                    ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ...
                    ' AND relAZ.LTE.' num2str(thresh_relAZ(2))  ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ...
                    ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND minCTT.GTE.' num2str(thresh_CTT(1)) ...
                    ' AND LT.' num2str(thresh_CTT(2))...
                    ' AND minCTH.GTE.' num2str(thresh_CTH(1)) ' AND LT.' num2str(thresh_CTH(2)) ...
                    ' AND meanTau.GTE.' num2str(thresh_tau(1)) ' AND LT.' num2str(thresh_tau(2)) ...
                    'iceCF allowed, no homog screening'...
                    ];                                                                
                
                
%            case 'NP + CF + MEAN sensZA + MEAN relAZ + stdLWP + MEAN solarZA'
%               screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.00001 & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & stdW_time3(ilat,ilon,itime)>thresh_stdW(1)/100 & stdW_time3(ilat,ilon,itime)<thresh_stdW(2)/100 & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND stdW.GTE.' num2str(thresh_stdW(1)) ' AND stdW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2))];
  %only when have no ice+combined CF
             case 'NP + CF + MEAN sensZA + MEAN relAZ + stdLWP + MEAN solarZA'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.001 & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & stdW_time3(ilat,ilon,itime)>thresh_stdW(1)/100 & stdW_time3(ilat,ilon,itime)<thresh_stdW(2)/100 & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND stdW.GTE.' num2str(thresh_stdW(1)) ' AND stdW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2))];                
                
%             case 'NP + CF + MEAN sensZA + MEAN relAZ + stdLWP + MEAN solarZA'
%                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & stdW_time3(ilat,ilon,itime)>thresh_stdW(1)/100 & stdW_time3(ilat,ilon,itime)<thresh_stdW(2)/100 & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND stdW.GTE.' num2str(thresh_stdW(1)) ' AND stdW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2))];                        
%             case 'NP + CF + MEAN sensZA + MEAN relAZ + stdLWP + MEAN solarZA + mean_CTT'
%                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.001 & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & stdW_time3(ilat,ilon,itime)>thresh_stdW(1)/100 & stdW_time3(ilat,ilon,itime)<thresh_stdW(2)/100 & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND stdW.GTE.' num2str(thresh_stdW(1)) ' AND stdW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND CTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2)) ];                
  %allowing ice+combined CF, w/ CTT screening
             case 'NP + CF + MEAN sensZA + MEAN relAZ + stdLWP + MEAN solarZA + mean_CTT'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND CTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2)) 'iceCF allowed'];                                
    %only when have no ice+undet CF, w/ CTT screening
             case 'NP + CF + MEAN sensZA + MEAN relAZ + stdLWP + MEAN solarZA + mean_CTT + noice'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.001 & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND CTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2)) ' no ice CF'];                
                
             case 'NP + CF + MEAN sensZA + MEAN relAZ + stdLWP + MEAN solarZA + min_CTT'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2)  & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTT(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND minCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2)) 'iceCF allowed'];                                
    %only when have no ice+undet CF, w/ CTT screening
             case 'NP + CF + MEAN sensZA + MEAN relAZ + stdLWP + MEAN solarZA + min_CTT + noice'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.001 & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & homog_time3(ilat,ilon,itime)>thresh_stdW(1) & homog_time3(ilat,ilon,itime)<thresh_stdW(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTT(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND homogW.GTE.' num2str(thresh_stdW(1)) ' AND homogW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND minCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2)) ' no ice CF'];                                
                
             case 'NP + CF + MEAN sensZA + MEAN relAZ + MEAN solarZA + min_CTT + noice'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.001 & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTT(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND minCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2)) ' no ice CF'];                                
                
            case 'NP + CF + MEAN sensZA + MEAN relAZ + MEAN solarZA + min_CTT'
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTT(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND minCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))];                                                
                
            case 'NP + CF + MEAN sensZA + MEAN relAZ + MEAN solarZA + min_CTT + min_tau';         
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & Cloud_Optical_Thickness_Liquid_Minimum.timeseries3(ilat,ilon,itime) >= thresh_tau(1) & Cloud_Optical_Thickness_Liquid_Minimum.timeseries3(ilat,ilon,itime) < thresh_tau(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND minCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2)) ' AND minTau.GTE.' num2str(thresh_tau(1)) ' AND LT.' num2str(thresh_tau(2))];                                                
                
            case 'NP + CF + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT + min_tau';
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2) & Cloud_Optical_Thickness_Liquid_Minimum.timeseries3(ilat,ilon,itime) >= thresh_tau(1) & Cloud_Optical_Thickness_Liquid_Minimum.timeseries3(ilat,ilon,itime) < thresh_tau(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2)) ' AND minTau.GTE.' num2str(thresh_tau(1)) ' AND LT.' num2str(thresh_tau(2))];   
                
            case 'NP + CF + MEAN sensZA + MEAN relAZ + MEAN solarZA + mean_CTT';
                screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2)  )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2)) ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2)) ];                                                                
                
%trying to make a screening with the stuff that's available for older
%mockL3 data.
 case 'NP + CF mockL3';
    screen_str = ['( '...
        'Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP'...
        '& Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<thresh_CF(2) )'...
        ]; 
    thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GTE.' num2str(thresh_CF(1)) ' AND CF.LT.' num2str(thresh_CF(2))];   
        
case 'NP + CF mockL3 + meanCTH';
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP' ...
          '& Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<thresh_CF(2)' ...
          '& CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2) )'];
            thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GTE.' num2str(thresh_CF(1)) ' AND CF.LT.' num2str(thresh_CF(2)) ' AND meanCTH.GTE.' num2str(thresh_CTH(1)) ' AND meanCTH.LT.' num2str(thresh_CTH(2))];                        

        
case 'NP + CF mockL3 + meanCTH + meanCTT';
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP' ...
          '& Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<thresh_CF(2)' ...
          '& CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2) )'...
          '& Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2)' ...
          ];
        thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GTE.' num2str(thresh_CF(1)) ' AND CF.LT.' num2str(thresh_CF(2)) ' AND meanCTH.GTE.' num2str(thresh_CTH(1)) ' AND meanCTH.LT.' num2str(thresh_CTH(2)) ...
          ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND meanCTT.LT.' num2str(thresh_CTT(2)) ...
          ];         
      
case 'NP + CF mockL3 + meanCTH + meanCTT + meanReff';
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP' ...
          '& Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<thresh_CF(2)' ...
          '& CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2) )'...
          '& Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2)' ...
          '& Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime) > thresh_reff(1) & Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime) <= thresh_reff(2)' ...
          ];
        thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GTE.' num2str(thresh_CF(1)) ' AND CF.LT.' num2str(thresh_CF(2)) ' AND meanCTH.GTE.' num2str(thresh_CTH(1)) ' AND meanCTH.LT.' num2str(thresh_CTH(2)) ...
          ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND meanCTT.LT.' num2str(thresh_CTT(2)) ...
          ' AND meanReff.GTE.' num2str(thresh_reff(1)) ' AND meanReff.LT.' num2str(thresh_reff(2)) ...
          ];  

case 'NP + CF mockL3 + meanCTH + meanCTT + meanReff + SZA';
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP' ...
          '& Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<thresh_CF(2)' ...
          '& CTH.timeseries3(ilat,ilon,itime) >= thresh_CTH(1) & CTH.timeseries3(ilat,ilon,itime) < thresh_CTH(2) )'...
          '& Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) >= thresh_CTT(1) & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime) < thresh_CTT(2)' ...
          '& Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime) > thresh_reff(1) & Cloud_Effective_Radius_Liquid_Mean.timeseries3(ilat,ilon,itime) <= thresh_reff(2)' ...
          '& Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2)' ...          
          ];
        thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GTE.' num2str(thresh_CF(1)) ' AND CF.LT.' num2str(thresh_CF(2)) ' AND meanCTH.GTE.' num2str(thresh_CTH(1)) ' AND meanCTH.LT.' num2str(thresh_CTH(2)) ...
          ' AND meanCTT.GTE.' num2str(thresh_CTT(1)) ' AND meanCTT.LT.' num2str(thresh_CTT(2)) ...
          ' AND meanReff.GTE.' num2str(thresh_reff(1)) ' AND meanReff.LT.' num2str(thresh_reff(2)) ...
          ' AND SZA.GTE.' num2str(thresh_SZA(1)) ' AND SZA.LT.' num2str(thresh_SZA(2)) ...
          ];  
      
      
      


                
            case 'Pixel screening L2';
                screen_str = [' ( qapq_1km(1,:,:)==1 & qapq_1km(2,:,:)==3 & qapq_1km(3,:,:)==0 & qapq_1km(4,:,:)==1 & qapq_1km(5,:,:)==3 & qapp_1km(16,:,:)==2  & mask_1km(4,:,:)==1 )']; thresh_str=['Tau and re useful and confidence=3, single layer liquid, tau within bounds, no sunglint'];
                
             case 'Pixel screening L2 and CTT restriction';
                screen_str = [' ( qapq_1km(1,:,:)==1 & qapq_1km(2,:,:)==3 & qapq_1km(3,:,:)==0 & qapq_1km(4,:,:)==1 & qapq_1km(5,:,:)==3 & qapp_1km(16,:,:)==2  & mask_1km(4,:,:)==1 & shiftdim(t_top3,-1) >= thresh_CTT(1) & shiftdim(t_top3,-1) < thresh_CTT(2))']; thresh_str=['Tau and re useful and confidence=3, single layer liquid, tau within bounds, no sunglint CTT.GTE.' num2str(thresh_CTT(1)) ' AND LT.' num2str(thresh_CTT(2))];    
                
                
                
            otherwise
                iplot_global=9e99;  %if none of the screenings have been selected

        end

    case 'OLD'  

     switch screen_type   
    case 'CF_old';
        screen_str = [' ( Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_CF) )']; thresh_str=['CF.GTE.' num2str(thresh_CF)];
    case 'NP + CF + MAX sensZA';
        %using max sensor ZA
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_CF & Sensor_Zenith_Maximum.timeseries3(ilat,ilon,itime)<=thresh_sensZA )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GTE.' num2str(thresh_CF) ' AND MAXsensZA.LTE.' num2str(thresh_sensZA)];
    case 'NP + MAX sensZA';
        %using max sensor ZA
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Sensor_Zenith_Maximum.timeseries3(ilat,ilon,itime)<=thresh_sensZA )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND MAXsensZA.LTE.' num2str(thresh_sensZA)];
    case 'NP + CF test';
        screen_str = ['( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.01 )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2))];
    case 'NP + CF';
        fprintf(1,'\n*** MAKE sure that this is the correct CF - for mockL3 data use NP + CF mockL3***\n');
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.01 )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2))];        
    case 'NP + CF mockL3';
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2))];
    case 'NP + CF + min temp';
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.01 & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime)>=thresh_CTT )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND min CTT.GTE.' num2str(thresh_CTT) ' K'];
    case 'NP + min temp';
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime)>=thresh_CTT )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND min CTT.GTE.' num2str(thresh_CTT) ' K'];
    case 'NP + CF + min pressure + min temp'
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.01 & Cloud_Top_Pressure_Day_Minimum.timeseries3(ilat,ilon,itime)>=thresh_CTP & Cloud_Top_Temperature_Day_Minimum.timeseries3(ilat,ilon,itime)>=thresh_CTT )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND min CTP.GTE.' num2str(thresh_CTP) ' hPa AND min CTT.GTE.' num2str(thresh_CTT) ' K'];
    case 'NP + CF + mean pressure + mean temp'
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.01 & Cloud_Top_Pressure_Day_Mean.timeseries3(ilat,ilon,itime)>=thresh_CTP & Cloud_Top_Temperature_Day_Mean.timeseries3(ilat,ilon,itime)>=thresh_CTT )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND mean CTP.GTE.' num2str(thresh_CTP) ' hPa AND mean CTT.GTE.' num2str(thresh_CTT) ' K'];
    case 'NP + CF + min pressure'
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.01 & Cloud_Top_Pressure_Day_Minimum.timeseries3(ilat,ilon,itime)>=thresh_CTP )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND min CTP.GTE.' num2str(thresh_CTP) ' hPa'];
    case 'NP + CF + mean pressure'
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.01 & Cloud_Top_Pressure_Day_Mean.timeseries3(ilat,ilon,itime)>=thresh_CTP(1) & Cloud_Top_Pressure_Day_Mean.timeseries3(ilat,ilon,itime)<thresh_CTP(2))']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND mean CTP.GTE.' num2str(thresh_CTP(2)) 'AND.LT.' num2str(thresh_CTP(1)) ' hPa'];
    case 'NP + CF + (mean pressure - std_dev)'
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.01 & (Cloud_Top_Pressure_Day_Mean.timeseries3(ilat,ilon,itime) - Cloud_Top_Pressure_Day_Standard_Deviation.timeseries3(ilat,ilon,itime)) >=thresh_CTP(1) & (Cloud_Top_Pressure_Day_Mean.timeseries3(ilat,ilon,itime) + Cloud_Top_Pressure_Day_Standard_Deviation.timeseries3(ilat,ilon,itime)) <thresh_CTP(2)   )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND mean CTP +- stddevCTP.LT.' num2str(thresh_CTP(2)) 'AND.GTE.' num2str(thresh_CTP(1)) ' hPa'];        
    case 'NP + CF + (mean pressure - 2*std_dev)'
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & (Cloud_Fraction_Combined.timeseries3(ilat,ilon,itime) - Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime) )<0.01 & (Cloud_Top_Pressure_Day_Mean.timeseries3(ilat,ilon,itime) - 2*Cloud_Top_Pressure_Day_Standard_Deviation.timeseries3(ilat,ilon,itime)) >=thresh_CTP(1)  & (Cloud_Top_Pressure_Day_Mean.timeseries3(ilat,ilon,itime) + 2*Cloud_Top_Pressure_Day_Standard_Deviation.timeseries3(ilat,ilon,itime)) <thresh_CTP(2)  )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND mean CTP +- 2xstddevCTP.LT.' num2str(thresh_CTP(2)) 'AND.GTE.' num2str(thresh_CTP(1)) ' hPa'];                
    case 'NP';
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP )']; thresh_str=['NP.GTE.' num2str(thresh_NP)];
    case 'NP + CF + MEAN sensZA'
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2))];
    case 'NP + CF + MEAN sensZA + MEAN relAZ'
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2))']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2))];        
    case 'NP + CF + MEAN sensZA + MEAN relAZ + stdLWP'
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & stdW_time3(ilat,ilon,itime)>thresh_stdW(1)/100 & stdW_time3(ilat,ilon,itime)<thresh_stdW(2)/100)']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND stdW.GTE.' num2str(thresh_stdW(1)) ' AND stdW.LT.' num2str(thresh_stdW(2))];                
    case 'NP + CF + MEAN sensZA + MEAN relAZ + stdLWP + MEAN solarZA'
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)>thresh_relAZ(1) & Relative_Azimuth_Mean.timeseries3(ilat,ilon,itime)<=thresh_relAZ(2) & stdW_time3(ilat,ilon,itime)>thresh_stdW(1)/100 & stdW_time3(ilat,ilon,itime)<thresh_stdW(2)/100 & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>=thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2)) ' AND relAZ.GT.' num2str(thresh_relAZ(1)) ' AND relAZ.LTE.' num2str(thresh_relAZ(2)) ' AND stdW.GTE.' num2str(thresh_stdW(1)) ' AND stdW.LT.' num2str(thresh_stdW(2)) ' AND solarZA.GTE.' num2str(thresh_SZA(1)) ' AND solarZA.LT.' num2str(thresh_SZA(2))];                        
    case 'NP + CF + MAX solarZA'
%        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_CF & Solar_Zenith_Maximum.timeseries3(ilat,ilon,itime)<=thresh_maxSZA )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GTE.' num2str(thresh_CF) ' AND MAXsolarZA.LTE.' num2str(thresh_maxSZA)];
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Solar_Zenith_Maximum.timeseries3(ilat,ilon,itime)<thresh_maxSZA )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND maxSolarZA.LT.' num2str(thresh_maxSZA)];        
    case 'NP + CF + MIN solarZA'
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Solar_Zenith_Minimum.timeseries3(ilat,ilon,itime)<thresh_minSZA )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND minSolarZA.LT.' num2str(thresh_minSZA)];
    case 'NP + CF + MEAN solarZA'
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_SZA(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND meanSolarZA.GT.' num2str(thresh_SZA(1)) ' AND meanSolarZA.LTE.' num2str(thresh_SZA(2))];
    case 'NP + CF + MEAN solarZA + MEAN sensZA'
        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>thresh_CF(1) & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)<=thresh_CF(2) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_SZA(1) & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_SZA(2) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)>thresh_sensZA(1) & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA(2) )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GT.' num2str(thresh_CF(1)) ' AND CF.LTE.' num2str(thresh_CF(2)) ' AND meanSolarZA.GT.' num2str(thresh_SZA(1)) ' AND meanSolarZA.LTE.' num2str(thresh_SZA(2)) ' AND sensZA.GT.' num2str(thresh_sensZA(1)) ' AND sensZA.LTE.' num2str(thresh_sensZA(2))];        
    case 'am3 lat-lon'
        screen_str = [' ( am3_lat>=LAT_val(1) & am3_lat<=LAT_val(2) & am3_lon>LON_val(1) & am3_lon<=LON_val(2) )']; thresh_str=['LAT.GTE.' num2str(LAT_val(1)) ' AND LAT.LTE.' num2str(LAT_val(2)) ' AND LON.GT.' num2str(LON_val(1)) ' AND LON.LTE.' num2str(LON_val(2))];
    case 'gcm CTT-layer'
        screen_str = [' ( gcm_CTT_layer>=gcm_CTT_thresh(1) & gcm_CTT_layer<=gcm_CTT_thresh(2) )']; thresh_str=['CTT.GTE.' num2str(gcm_CTT_thresh(1)) ' AND CTT.LTE.' num2str(gcm_CTT_thresh(2))];        
        
        
        
    end
    
    
    
    otherwise %set these up
        %                                        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_CF )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GTE.' num2str(thresh_CF)];
        %                                        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_CF & Solar_Zenith_Maximum.timeseries3(ilat,ilon,itime)<=thresh_maxSZA )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GTE.' num2str(thresh_CF) ' AND maxSZA.LT.' num2str(thresh_maxSZA)];
        %                                        screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_NP & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=thresh_CF & Solar_Zenith_Maximum.timeseries3(ilat,ilon,itime)<=thresh_maxSZA & Sensor_Zenith_Mean.timeseries3(ilat,ilon,itime)<=thresh_sensZA )']; thresh_str=['NP.GTE.' num2str(thresh_NP) ' AND CF.GTE.' num2str(thresh_CF) ' AND maxSZA.LT.' num2str(thresh_maxSZA) ' AND sensZA.LTE.' num2str(thresh_sensZA)];

        %should do max sensorZA?
        %screen_str = [' ( Cloud_Fraction_Liquid_Pixel_Counts.timeseries3(ilat,ilon,itime)./Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=50 & Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=0.8 & Solar_Zenith_Mean.timeseries3(ilat,ilon,itime)<thresh_SZA )']; thresh_str=['NP.GTE.50 AND CF.GTE.0.8 AND SZA.LTE.' num2str(thresh_SZA)];
        %                            screen_str = [' (
        %                            Cloud_Fraction_Liquid.timeseries3(ilat,ilon,itime)>=0.8 )']; thresh_str='CF.GT.0.8';

        iplot_global=9e99;  %if none of the screenings have been selected

end

if exist('i_ocean_only_SCREEN') & i_ocean_only_SCREEN == 1
    load('~/amsre_land_mask.mat');
    landmask3D = repmat(amsre_land_mask,[1 1 size(Cloud_Fraction_Liquid_Pixel_Counts.timeseries3,3)]);
    for iLM=1:length(MLAT)
        ilat_landmask(iLM) = find(MLAT_standard==MLAT(iLM));
    end
    for iLM=1:length(MLON)
        ilon_landmask(iLM) = find(MLON_standard==MLON(iLM));
    end
    
    if iplot_global<8e99
        screen_str = [screen_str ' & ']; %add teh & for selecting another logical, but only if have one already
    end
    
    screen_str = [screen_str ' ( landmask3D(ilat_landmask,ilon_landmask,itime)>-0.01 )'];
    iplot_global = iplot_global_orig;
end


if iplot_global==1
    eval(['ihtot=find( ~(' screen_str ') );']); %put brackets around the logical after the ~
    %to make sure that it is all included.
elseif iplot_global>8e99
    thresh_str='';
    if exist('thresh_str_multiL2')
        thresh_str=thresh_str_multiL2;
    end
else
    eval(['ihtot=find( ' screen_str ');']);
end


